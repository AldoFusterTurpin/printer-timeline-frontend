<mat-spinner style="margin:0 auto;" *ngIf="loadingSpinner; else dataReady"></mat-spinner>

<ng-template #dataReady>
    <div>
        <!-- 
            if 'height: 100vh' is set in CSS, the tex "Close" of the close button of the left sidenav 
            is sometimes empty (an unexpected thing). That's why the style is here inline. 
        -->
        <mat-sidenav-container style="height:'100vh'">
            <mat-sidenav #rightSidenav mode="side" opened="false" position="end">
                <button class="close-sidenav-button" mat-raised-button color="accent"
                    (click)="rightSidenav.close()">Close
                </button>

                <h4>Details</h4>
                <hr class="solid">

                <div *ngIf="details !== undefined && details !== null">
                    <p><b>Timestamp</b> {{ stringDateToDateObject(details[0]['Value']).toISOString().slice(0, -1).replace('T', ' ') }}</p>
                    <p><b>PN</b> {{details[1]['Value']}}</p>
                    <p><b>SN</b> {{details[2]['Value']}}</p>
                    <p><b>Topic</b> {{details[6]['Value']}}</p>

                    <button mat-icon-button color="primary" aria-label="Download icon" matTooltip="Preview"
                        (click)="getStoredObject(details[4]['Value'], details[3]['Value'], details[5]['Value'])">
                        <mat-icon class="icon-display">preview</mat-icon>
                    </button>

                    <button mat-icon-button color="primary" aria-label="Download icon" matTooltip="Download">
                        <mat-icon class="icon-display">cloud_download</mat-icon>
                    </button>
                </div>

                <mat-progress-bar *ngIf="loadingS3Object" mode="indeterminate" color="primary"> </mat-progress-bar>
            </mat-sidenav>

            <mat-sidenav class="custom-sidenav-container" #leftSidenav mode="over" opened="false" position="start">
                <button id="close-left-sidenav-button" mat-raised-button color="accent"
                    (click)="leftSidenav.close()">Close preview
                </button>

                <!-- TODO: is this bloc correct? Should be S3error instead? -->
                <div *ngIf="httpOpenXmlError !== undefined;">
                    <p>Response status code: {{httpOpenXmlError?.status}}</p>
                    <p>Response status text: {{httpOpenXmlError?.statusText}}</p>
                    <p>Response error: {{httpOpenXmlError?.error}}</p>
                </div>
                <!-- -------------------------------------------------------- -->

                <div *ngIf="S3Object !== undefined && S3Object !== null">
                    {{S3Object}}
                </div>
            </mat-sidenav>

            <mat-sidenav-content>
                <div id="timeline-page-wrapper">
                    <div id="timelines-wrapper">
                        <div id="openxml-section">
                            <p> <strong>OpenXML</strong> section</p>
                            <div *ngIf="httpOpenXmlError !== undefined;">
                                <p>Response status code: {{httpOpenXmlError?.status}}</p>
                                <p>Response status text: {{httpOpenXmlError?.statusText}}</p>
                                <p>Response error: {{httpOpenXmlError?.error}}</p>
                            </div>

                            <div *ngIf="(uploadedXmlTimelineData !== undefined) && (uploadedXmlTimelineData !== null)">
                                <app-single-timeline [timelineData]="uploadedXmlTimelineData">
                                </app-single-timeline>
                            </div>
                            <hr class="solid">
                        </div>
                    </div>
                </div>
            </mat-sidenav-content>
        </mat-sidenav-container>
    </div>
</ng-template>